package usbguard.IPC;

import "Message.proto";
import "Rule.proto";


message listDevicesRequest {
  required MessageHeader header = 1;
  required string query = 2;
}

message listDevicesResponse {
  required MessageHeader header = 1;
  repeated Rule devices = 2;
}


message applyDevicePolicyRequest {
  required MessageHeader header = 1;
  required uint32 id = 2;
  required uint32 target = 3;
  required bool permanent = 4;
}

message applyDevicePolicyResponse {
  required MessageHeader header = 1;
  required uint32 rule_id = 2;
}


message DevicePresenceChangedSignal {
  required uint32 id = 1;
  required uint32 event = 2;
  required uint32 target = 3;
  required string device_rule = 4;
  required uint32 rule_id = 5;
}

message DevicePolicyChangedSignal {
  required uint32 id = 1;
  required uint32 target = 2;
}
